<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Connecting to Deriv...</title>
    <style>
        body {
            background-color: #0d1b2a;
            color: #00ff99;
            font-family: monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    Connecting to Deriv<span id="dots">...</span>

    <script>
        const TRUSTED_PARENT = 'https://brian61957.github.io';

        // Animate dots
        let dotCount = 0;
        setInterval(() => {
            dotCount = (dotCount + 1) % 4;
            document.getElementById('dots').textContent = '.'.repeat(dotCount);
        }, 400);

        // Get token from hash or query
        const urlParams = new URLSearchParams(window.location.search);
        let token = urlParams.get('token1');
        if (!token && window.location.hash) {
            const hashParams = new URLSearchParams(window.location.hash.substring(1));
            token = hashParams.get('access_token');
        }

        if (token) {
            // Store in sessionStorage only
            sessionStorage.setItem('deriv_access_token', token);

            // Clean URL
            window.history.replaceState({}, document.title, window.location.pathname);

            // Redirect to main tool
            window.location.href = 'index.html';
        } else {
            document.body.textContent = 'No token found. Please reconnect.';
        }
    </script>
</body>
</html>
